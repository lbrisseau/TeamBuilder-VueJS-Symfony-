<!DOCTYPE html>
<html>

<head>
	<title>Mini projet Equipe de personnes</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
		integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
		crossorigin="anonymous" />



	<style>
		.divListUser,
		.divUser {
			background-color: #ccc;
			padding: 20px;
			border-radius: 20px
		}

		.divListUser {
			margin-top: 20px;
			border-radius: 20px
		}

		.divTeam {
			background-color: #ccc;
			padding: 20px;
			border-radius: 20px
		}

		#tabListUser td {
			height: 45px;
			width: 120px;
		}
	</style>
</head>

<body>
	<div class="container mt-3" id="teambuilder">

		<div class="row">
			<div class="col-md-8">
				<div class="divTeam">
					<div class="row">
						<div class="col-4">

							<input class="form-control" id="team" placeholder="Nom de l'Equipe">
						</div>
						<div class="col-8">
							<button class="btn btn-success" id="btnAddTeam">
								<i class="fa fa-plus"></i>
							</button>
						</div>
					</div>
				</div>
				<div id="demo"></div>
			</div>
			<div class="col-md-4">
				<div class="divUser">
					<div class="form-group">
						<input class="form-control" placeholder="PrÃ©nom" type="text" id="prenom" v-model="prenom" />
					</div>
					<div class="form-group">
						<input class="form-control" placeholder="Nom" type="text" id="nom" v-model="nom" />
					</div>
					<div class="form-group">
						<select class="form-control" id="MyUserTeam">
							<option value="0">Pas d'Equipe</option>
						</select>
					</div>
					<div class="form-group text-center mb-0">
						<button class="btn btn-success btn-lg" id="btnAddUser" @click="ajouterPersonne()">
							<i class="fa fa-plus"></i>
						</button>
					</div>

				</div>
				<div class="divListUser">
					<table id="tabListUser">
						<tr class="text-center" v-for="(p, index) in tabPersonnes">
							<td>{{ p.prenom }} {{ p.nom }}</td>
							<td>
								<button class="btn btn-danger" @click="supprimerPersonne(index)">
									<i class="fa fa-trash"></i>
								</button>
							</td>
						</tr>
					</table>
				</div>

			</div> <!-- col4 -->
		</div><!-- row -->

	</div><!-- container -->
	<script src="https://cdn.jsdelivr.net/npm/vue"></script>
	<!-- cdn axios -->
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

	<script>
		const app = new Vue(
			{
				el: '#teambuilder',
				data:
				{
					tabPersonnes: [],
					tabEquipes: [],
					nom: '',
					prenom: '',
				},
				methods:
				{
					ajouterPersonne() {
						let p = {}; // creation d objet
						p.prenom = this.prenom;
						p.nom = this.nom;
						this.prenom = '';
						this.nom = '';

						// on ajoute ds le tableau
						let url = 'http://localhost/TP%20VueJS/TP4%20team/tp/back/public/personnes/';
						axios.post(url, {
							prenom: p.prenom,
							nom: p.nom
						})
							.then(response => {
								objId = response.data;
								console.log(objId); 
								p.id = objId.id;
								this.tabPersonnes.push(p);
								console.log(this.tabPersonnes);
							});
					},
					supprimerPersonne(i) {
						let id = this.tabPersonnes[i].id;
						let url = 'http://localhost/TP%20VueJS/TP4%20team/tp/back/public/personnes/' + id;
						axios.delete(url)
							.then(response => {
								console.log(response.data);
								this.tabPersonnes.splice(i, 1); 
							});
					},
				},
				mounted() {
					let url = 'http://localhost/TP%20VueJS/TP4%20team/tp/back/public/personnes/';
					axios.get(url)
						.then(
							response => {
								this.tabPersonnes = response.data;
							});
				}
			});
	</script>



</body>

</html>